<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python Runner Tool</title>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.26.2/full/pyodide.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>
    <script src="https://unpkg.com/monaco-editor@0.47.0/min/vs/loader.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1e1e1e;
            color: #d4d4d4;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        #header {
            background-color: #252526;
            padding: 10px;
            text-align: center;
            border-bottom: 1px solid #3c3c3c;
        }
        #mode-selector {
            margin-bottom: 10px;
        }
        button {
            background-color: #007acc;
            color: white;
            border: none;
            padding: 8px 16px;
            margin: 0 5px;
            cursor: pointer;
            border-radius: 4px;
        }
        button:hover {
            background-color: #005f9e;
        }
        #main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        #editor-container, #bash-container {
            flex: 1;
            display: none;
            flex-direction: column;
            padding: 10px;
        }
        #editor {
            height: 60%;
            border: 1px solid #3c3c3c;
            border-radius: 4px;
            overflow: hidden;
        }
        #bash-input {
            width: 100%;
            height: 50px;
            background-color: #252526;
            color: #d4d4d4;
            border: 1px solid #3c3c3c;
            padding: 10px;
            font-family: 'Consolas', monospace;
            resize: none;
        }
        #run-button {
            margin-top: 10px;
            align-self: flex-start;
        }
        #console {
            flex: 1;
            background-color: #0d1117;
            color: #c9d1d9;
            padding: 10px;
            overflow-y: auto;
            border: 1px solid #3c3c3c;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
            white-space: pre-wrap;
        }
        #docs-container {
            width: 300px;
            background-color: #252526;
            padding: 10px;
            overflow-y: auto;
            border-left: 1px solid #3c3c3c;
        }
        #docs-input {
            width: 100%;
            background-color: #1e1e1e;
            color: #d4d4d4;
            border: 1px solid #3c3c3c;
            padding: 8px;
            margin-bottom: 10px;
        }
        #docs-output {
            white-space: pre-wrap;
            font-family: 'Consolas', monospace;
        }
        .active {
            display: flex;
        }
    </style>
</head>
<body>
    <div id="header">
        <h2>Python Runner Tool</h2>
        <div id="mode-selector">
            <button onclick="switchMode('editor')">Editor Mode</button>
            <button onclick="switchMode('bash')">Bash Mode</button>
        </div>
    </div>
    <div id="main-container">
        <div id="editor-container">
            <div id="editor"></div>
            <button id="run-button" onclick="runCode()">Run Code</button>
            <div id="console"></div>
        </div>
        <div id="bash-container">
            <textarea id="bash-input" placeholder="Enter Python command and press Enter..."></textarea>
            <div id="console-bash"></div>
        </div>
        <div id="docs-container">
            <h3>Python Learning Guidelines</h3>
            <p>Enter a module name (e.g., 'math') or function (e.g., 'math.sin') to get help:</p>
            <input id="docs-input" type="text" placeholder="e.g., math">
            <button onclick="getHelp()">Get Help</button>
            <div id="docs-output"></div>
            <h4>Standard Libraries Overview</h4>
            <ul>
                <li><strong>math</strong>: Mathematical functions (sin, cos, sqrt, etc.)</li>
                <li><strong>random</strong>: Generate random numbers, choices, etc.</li>
                <li><strong>datetime</strong>: Date and time manipulation.</li>
                <li><strong>os</strong>: Operating system interactions (files, directories).</li>
                <li><strong>sys</strong>: System-specific parameters and functions.</li>
                <li><strong>json</strong>: JSON encoding/decoding.</li>
                <li><strong>re</strong>: Regular expressions.</li>
                <li><strong>collections</strong>: Specialized container datatypes.</li>
                <li><strong>itertools</strong>: Functions creating iterators for efficient looping.</li>
                <li>And many more... Use help() for details.</li>
            </ul>
            <p>To learn: Experiment in the runner, use help(), and build small scripts.</p>
        </div>
    </div>

    <script>
        let pyodide;
        let editor;
        let currentMode = 'editor';
        let bashNamespace = {};

        async function loadPyodideAndPackages() {
            pyodide = await loadPyodide();
            console.log('Pyodide loaded');
            document.getElementById('console').innerText = 'Pyodide ready.\n';
            document.getElementById('console-bash').innerText = 'Pyodide ready.\n';
        }

        require.config({ paths: { vs: 'https://unpkg.com/monaco-editor@0.47.0/min/vs' } });
        require(['vs/editor/editor.main'], function () {
            editor = monaco.editor.create(document.getElementById('editor'), {
                value: '# Write your Python code here\nprint("Hello, World!")',
                language: 'python',
                theme: 'vs-dark',
                automaticLayout: true
            });
        });

        function switchMode(mode) {
            currentMode = mode;
            document.getElementById('editor-container').classList.remove('active');
            document.getElementById('bash-container').classList.remove('active');
            if (mode === 'editor') {
                document.getElementById('editor-container').classList.add('active');
            } else {
                document.getElementById('bash-container').classList.add('active');
            }
        }

        async function runCode() {
            const code = editor.getValue();
            const consoleDiv = document.getElementById('console');
            consoleDiv.innerText += '>>> Running code...\n';
            try {
                const result = await pyodide.runPythonAsync(code);
                consoleDiv.innerText += (result || '') + '\n';
            } catch (err) {
                consoleDiv.innerText += err + '\n';
            }
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }

        document.getElementById('bash-input').addEventListener('keydown', async function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                const command = this.value.trim();
                if (command) {
                    const consoleDiv = document.getElementById('console-bash');
                    consoleDiv.innerText += '>>> ' + command + '\n';
                    try {
                        const result = await pyodide.runPythonAsync(command, { globals: pyodide.toPy(bashNamespace) });
                        bashNamespace = pyodide.globals.toJs();
                        consoleDiv.innerText += (result || '') + '\n';
                    } catch (err) {
                        consoleDiv.innerText += err + '\n';
                    }
                    consoleDiv.scrollTop = consoleDiv.scrollHeight;
                }
                this.value = '';
            }
        });

        async function getHelp() {
            const query = document.getElementById('docs-input').value.trim();
            if (query) {
                const docsOutput = document.getElementById('docs-output');
                docsOutput.innerText = 'Fetching help...\n';
                try {
                    const code = `import sys\nhelp_output = []\nsys.stdout.write = lambda s: help_output.append(s)\nhelp(${query})\nprint(''.join(help_output))`;
                    const result = await pyodide.runPythonAsync(code);
                    docsOutput.innerText = result;
                } catch (err) {
                    docsOutput.innerText = err;
                }
            }
        }

        loadPyodideAndPackages();
        switchMode('editor');
    </script>
</body>
</html>

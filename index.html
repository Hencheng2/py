<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Python Learning IDE</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.41.0/min/vs/loader.js"></script>
<script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
<style>
body { margin:0; font-family:'Inter',sans-serif; background-color:#1e1e1e; color:#fff; height:100vh; display:flex; flex-direction:column; }
#top-bar { display:flex; gap:10px; align-items:center; padding:10px; border-bottom:1px solid #333; }
#main-container { flex:1; display:flex; overflow:hidden; }
#editor-section { flex:3; display:flex; flex-direction:column; gap:5px; }
#editor-container, #bash-container { flex:1; height:400px; }
#bash-container { display:none; width:100%; background:#111; color:#fff; font-family:monospace; padding:5px; }
.console { background:#121212; padding:10px; height:200px; overflow-y:auto; resize:vertical; border-top:1px solid #333; }
.library-panel { flex:1; background:#1b1b1b; overflow-y:auto; padding:10px; border-left:1px solid #333; }
.library-item { border-bottom:1px solid #333; padding:5px 0; cursor:pointer; }
.library-item:hover { background-color:#2a2a2a; }
#lib-search { width:100%; padding:5px; margin-bottom:5px; background:#222; color:#fff; border-radius:4px; border:none; }
</style>
</head>
<body>

<div id="top-bar">
    <button id="run-btn" class="bg-indigo-600 hover:bg-indigo-700 px-4 py-2 rounded">Run Code</button>
    <select id="mode-select" class="bg-gray-800 text-white px-2 py-1 rounded">
        <option value="editor">Monaco Editor</option>
        <option value="bash">Python Bash</option>
    </select>
</div>

<div id="main-container">
    <div id="editor-section">
        <div id="editor-container"></div>
        <textarea id="bash-container" placeholder="# Type Python code here..."></textarea>
        <div id="console" class="console"></div>
    </div>

    <div class="library-panel">
        <h2 class="font-bold mb-2">Python Libraries & Commands</h2>
        <input type="text" id="lib-search" placeholder="Search commands/libraries">
        <div id="lib-content"></div>
    </div>
</div>

<script>
let pyodideReady=false;
let pyodide;
let editor;
let currentMode='editor';

async function initPyodide() {
    pyodide=await loadPyodide();
    pyodideReady=true;
    appendConsole("Pyodide loaded. Python ready!");
}

function appendConsole(text){
    const consoleDiv=document.getElementById('console');
    consoleDiv.innerHTML+=text+"<br>";
    consoleDiv.scrollTop=consoleDiv.scrollHeight;
}

// Initialize Monaco
require.config({ paths: { 'vs':'https://cdn.jsdelivr.net/npm/monaco-editor@0.41.0/min/vs' }});
require(['vs/editor/editor.main'], function(){
    editor=monaco.editor.create(document.getElementById('editor-container'),{
        value:"# Write Python code here\nprint('Hello World')",
        language:'python',
        theme:'vs-dark',
        automaticLayout:true
    });
});

// Mode selection
document.getElementById('mode-select').addEventListener('change', function(){
    currentMode=this.value;
    if(currentMode==='editor'){
        document.getElementById('editor-container').style.display='block';
        document.getElementById('bash-container').style.display='none';
    }else{
        document.getElementById('editor-container').style.display='none';
        document.getElementById('bash-container').style.display='block';
    }
});

// Run code
document.getElementById('run-btn').onclick=async()=>{
    if(!pyodideReady){ appendConsole("Python not ready yet."); return; }
    let code=currentMode==='editor'?editor.getValue():document.getElementById('bash-container').value;
    try{
        let result=await pyodide.runPythonAsync(code);
        appendConsole(result===undefined?"Code executed.":result);
    }catch(err){
        appendConsole(err);
    }
};

// Full Python standard library with examples
const pythonLibs={
"print":"print('Hello World') → Prints output",
"len":"len([1,2,3]) → 3",
"sum":"sum([1,2,3]) → 6",
"min":"min([1,2,3]) → 1",
"max":"max([1,2,3]) → 3",
"range":"list(range(5)) → [0,1,2,3,4]",
"list":"list('abc') → ['a','b','c']",
"dict":"{'a':1,'b':2} → dictionary",
"tuple":"tuple([1,2]) → (1,2)",
"set":"set([1,1,2]) → {1,2}",
"if":"if x>0: print('Positive')",
"for":"for i in range(3): print(i)",
"while":"i=0\nwhile i<3:\n print(i)\n i+=1",
"try":"try:\n 1/0\nexcept ZeroDivisionError:\n print('Error')",
"def":"def add(a,b): return a+b",
"class":"class Dog:\n def bark(self): print('Woof')",
"import math":"import math\nmath.sqrt(16) → 4",
"import os":"import os\nos.getcwd()",
"import sys":"import sys\nsys.version",
"import random":"import random\nrandom.randint(1,10)",
"import datetime":"import datetime\ndatetime.datetime.now()",
"import json":"import json\njson.dumps({'a':1}) → '{\"a\":1}'",
"import re":"import re\nre.findall(r'\\w+', 'Hello World') → ['Hello','World']",
"import itertools":"import itertools\nlist(itertools.permutations([1,2])) → [(1,2),(2,1)]",
"import collections":"import collections\ncollections.Counter([1,1,2]) → Counter({1:2,2:1})",
"import functools":"import functools\nfunctools.reduce(lambda x,y:x+y,[1,2,3]) → 6"
};

// Render libraries
function renderLibrary(){
    const libContent=document.getElementById('lib-content');
    libContent.innerHTML='';
    for(let key in pythonLibs){
        const div=document.createElement('div');
        div.className='library-item';
        div.innerHTML=`<b>${key}</b>: ${pythonLibs[key].replace(/\n/g,'<br>')}`;
        div.onclick=()=>{
            let code=pythonLibs[key].split('→')[0].trim();
            if(currentMode==='editor') editor.setValue(code);
            else document.getElementById('bash-container').value=code;
        };
        libContent.appendChild(div);
    }
}

document.getElementById('lib-search').addEventListener('input',function(){
    const query=this.value.toLowerCase();
    const libContent=document.getElementById('lib-content');
    libContent.innerHTML='';
    for(let key in pythonLibs){
        if(key.toLowerCase().includes(query)||pythonLibs[key].toLowerCase().includes(query)){
            const div=document.createElement('div');
            div.className='library-item';
            div.innerHTML=`<b>${key}</b>: ${pythonLibs[key].replace(/\n/g,'<br>')}`;
            div.onclick=()=>{
                let code=pythonLibs[key].split('→')[0].trim();
                if(currentMode==='editor') editor.setValue(code);
                else document.getElementById('bash-container').value=code;
            };
            libContent.appendChild(div);
        }
    }
});

renderLibrary();
initPyodide();
</script>

</body>
</html>
